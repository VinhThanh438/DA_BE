enum ImportType {
  purchased   // Nhập từ NCC
  finished    // Nhập thành phẩm
}

enum ExportType {
  inventory   // Xuất kho thường
  material    // Xuất nguyên vật liệu
}

model WareHouses {
  id         Int       @id @default(autoincrement())
  code       String    @default(cuid())
  name       String
  phone      String?
  address    String?
  note       String?
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  @@map("ware_houses")
  ImportDetails ImportDetails[]
  ExportDetails ExportDetails[]
}

model Imports {
  id               Int         @id @default(autoincrement())
  imported_at      DateTime    @default(now())
  code             String      @unique
  delivery         String?      // Đơn vị vận chuyển
  transportation_number String? // Số xe vận chuyển
  organization_id  Int?         // Đơn vị mua hàng
  partner_id       Int?         // Nhà cung cấp / Khách hàng
  employee_id      Int?         // Nhân viên nhập kho
  type             ImportType
  files             Json?        @default("[]")
  note             String?      // Ghi chú đơn hàng

  created_at       DateTime      @default(now())
  updated_at       DateTime      @updatedAt

  organization        Organizations?    @relation(fields: [organization_id], references: [id])
  partner        Partners?              @relation(fields: [partner_id], references: [id])
  employee        Employees?            @relation(fields: [employee_id], references: [id])

  @@map("imports")
  ImportDetails ImportDetails[]
  OrderImportDetails OrderImportDetails[]
}

model ImportDetails {
  id               Int         @id @default(autoincrement())
  product_id       Int
  import_id       Int
  warehouse_id     Int?
  quantity         Int?          // Số lượng
  price            Decimal?      // Đơn giá
  discount         Int?         // Giảm giá (%)
  vat              Int?         // Thuế VAT
  note             String?

  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt

  warehouse        WareHouses?  @relation(fields: [warehouse_id], references: [id])
  product        Products?  @relation(fields: [product_id], references: [id])
  import        Imports?  @relation(fields: [import_id], references: [id])
  @@map("import_details")
}

model Exports {
  id               Int         @id @default(autoincrement())
  exported_at      DateTime    @default(now())
  code             String      @unique
  organization_id  Int?
  partner_id       Int?
  employee_id      Int?
  delivery         String?      // Đơn vị vận chuyển
  transportation_number String? // Số xe vận chuyển
  note             String?
  type             ExportType
  files             Json?        @default("[]")

  organization        Organizations?    @relation(fields: [organization_id], references: [id])
  partner        Partners?              @relation(fields: [partner_id], references: [id])
  employee        Employees?            @relation(fields: [employee_id], references: [id])

  created_at       DateTime    @default(now())
  updated_at       DateTime    @updatedAt

  @@map("exports")
  ExportDetails ExportDetails[]
  OrderExportDetails OrderExportDetails[]
}

model ExportDetails {
  id               Int         @id @default(autoincrement())
  export_id        Int
  product_id       Int
  warehouse_id     Int?
  quantity         Int?          // Số lượng
  price            Decimal?      // Đơn giá
  discount         Int?         // Giảm giá (%)
  vat              Int?         // Thuế VAT
  note             String?

  export        Exports? @relation(fields: [export_id], references: [id])
  warehouse        WareHouses? @relation(fields: [warehouse_id], references: [id])
  product        Products? @relation(fields: [product_id], references: [id])

  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  @@map("export_details")
}