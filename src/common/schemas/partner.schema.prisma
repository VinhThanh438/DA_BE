enum PartnerType {
  customer // khach hang
  supplier // nha cung cap
  delivery // giao hang
  default
}

model Partners {
  id      Int         @id @default(autoincrement())
  code    String      @default(cuid())
  name    String    
  phone   String?
  note    String?
  email   String?
  tax     String?
  type    PartnerType @default(default) 
  addresses Json?           @default("[]")
  representatives  Json?    @default("[]") 
  // representative_name  String?
  // representative_phone String?
  // representative_title String? 
  // representative_email String?

  organization_id  Int?
  partner_group_id Int?
  clause_id        Int? 
  sale_staff_id    Int?

  is_default Boolean @default(false)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  partner_group     PartnerGroups?      @relation(fields: [partner_group_id], references: [id], onDelete: Cascade)
  organization      Organizations?      @relation(fields: [organization_id], references: [id], onDelete: Cascade)
  clause            Clauses?            @relation(fields: [clause_id], references: [id], onDelete: Cascade)
  sale_staff        Employees?          @relation(fields: [sale_staff_id], references: [id], onDelete: Cascade)
  bank_accounts      BankAccounts[]
  invoices           Invoices[]
  quotations        Quotations[]
  orders            Orders[]
  productions       Productions[]
  finance_records    FinanceRecords[]
  transaction_orders TransactionOrders[]

  @@map("partners")
  inventory_as_supplier Inventories[] @relation("Supplier")
  inventory_as_customer Inventories[] @relation("Customer")
  inventory_as_delivery Inventories[] @relation("Delivery")
  @@unique([name, type])
  depts Depts[]
  contracts Contracts[]
}


model PartnerGroups {
  id       Int         @id @default(autoincrement())
  name     String
  type     PartnerType @default(default) // loai doi tac
  partners Partners[]

  @@map("partner_groups")
}

// Dieu khoan
model Clauses {
  id       Int        @id @default(autoincrement())
  name     String     @unique
  content  String?

  max_dept_amount Decimal? // so tien no toi da
  max_dept_day    Int? // so ngay no toi da

  partners Partners[]

  @@map("clauses")
}
